# Comandos Git limpios y directos (PowerShell)
# Ejecuta en el root del proyecto: C:\Users\Lenovo\Desktop\Barbe_app

cd C:\Users\Lenovo\Desktop\Barbe_app

# 1) Backup rápido por si acaso
Compress-Archive -Path . -DestinationPath ..\Barbe_app-backup.zip

# 2) Asegurar .gitignore para no subir node_modules ni .env
Add-Content -Path .gitignore -Value "`n# Node / JS`nnode_modules/`n# Env / secrets`.env`n"

# 3) Quitar node_modules del índice (no borra la carpeta local)
git rm -r --cached node_modules

# 4) Quitar archivos con keys del índice (mantener localmente)
git rm --cached api.txt supacomandos.txt baken/.env || git rm --cached api.txt supacomandos.txt || Write-Output 'Algunos archivos no estaban en index'

# 5) Añadir cambios y commitear
git add .gitignore
git add -A
git commit -m "chore: remove sensitive files from index and ignore node_modules"

# 6) Asegurar que la rama local se llama 'main' y empujar al remoto
git branch -M main
git push -u origin main

# 7) (Opcional, DESTRUC.) Si quieres forzar un repo limpio en remoto (sobrescribe historial)
# usar sólo si estás seguro:
# git checkout --orphan temp-clean
# git rm -rf --cached .
# echo "# agenda_barbe (cleaned)" > README.md
# git add README.md
# git commit -m "chore: reset repo to clean state"
# git push -u origin temp-clean:main --force
# git checkout -B main
# git branch -D temp-clean

# FIN
